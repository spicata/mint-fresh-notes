/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __markAsModule = (target) => __defProp(target, "__esModule", { value: true });
var __export = (target, all) => {
  __markAsModule(target);
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __reExport = (target, module2, desc) => {
  if (module2 && typeof module2 === "object" || typeof module2 === "function") {
    for (let key of __getOwnPropNames(module2))
      if (!__hasOwnProp.call(target, key) && key !== "default")
        __defProp(target, key, { get: () => module2[key], enumerable: !(desc = __getOwnPropDesc(module2, key)) || desc.enumerable });
  }
  return target;
};
var __toModule = (module2) => {
  return __reExport(__markAsModule(__defProp(module2 != null ? __create(__getProtoOf(module2)) : {}, "default", module2 && module2.__esModule && "default" in module2 ? { get: () => module2.default, enumerable: true } : { value: module2, enumerable: true })), module2);
};
var __async = (__this, __arguments, generator) => {
  return new Promise((resolve, reject) => {
    var fulfilled = (value) => {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    };
    var rejected = (value) => {
      try {
        step(generator.throw(value));
      } catch (e) {
        reject(e);
      }
    };
    var step = (x) => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);
    step((generator = generator.apply(__this, __arguments)).next());
  });
};

// main.ts
__export(exports, {
  InsertCommandIdModel: () => InsertCommandIdModel,
  KeySequenceModal: () => KeySequenceModal,
  KeySequenceShortcutSettingTab: () => KeySequenceShortcutSettingTab,
  default: () => KeySequenceShortcutPlugin
});
var import_obsidian = __toModule(require("obsidian"));
var import_obsidian2 = __toModule(require("obsidian"));
var DEFAULT_SETTINGS = {
  kssrc_file_path: "kssrc.md"
};
var KeySequenceShortcutSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    new import_obsidian.Setting(containerEl).setName("Config File").addText((text) => text.setPlaceholder("").setValue(this.plugin.settings.kssrc_file_path).onChange((value) => __async(this, null, function* () {
      this.plugin.settings.kssrc_file_path = value;
      yield this.plugin.saveSettings();
    })));
  }
};
var g_all_key_items = [];
var KeySequenceModal = class extends import_obsidian2.SuggestModal {
  getSuggestions(query) {
    const result = g_all_key_items.find((key_item) => {
      return key_item.key_sequence == query;
    });
    if (result != null) {
      this.close();
      this.delay(100).then((data) => {
        this.execute(result);
      });
    }
    return g_all_key_items.filter((key_item) => key_item.key_sequence.startsWith(query));
  }
  renderSuggestion(key_item, el) {
    el.createEl("div", { text: key_item.key_sequence + ": " + (key_item.description == "" ? key_item.command : key_item.description) });
  }
  onChooseSuggestion(key_item, evt) {
    this.execute(key_item);
  }
  execute(key_item) {
    console.log(`Execute ${key_item.key_sequence}: ${key_item.command}`);
    this.app.commands.executeCommandById(key_item.command);
  }
  delay(ms) {
    return __async(this, null, function* () {
      return new Promise((resolve) => setTimeout(resolve, ms));
    });
  }
};
var InsertCommandIdModel = class extends import_obsidian.FuzzySuggestModal {
  getItems() {
    return Object.values(this.app.commands.commands);
  }
  getItemText(item) {
    return item.name + " -> " + item.id;
  }
  onChooseItem(item, evt) {
    console.log(this.getItemText(item));
    const view = this.app.workspace.getActiveViewOfType(import_obsidian.MarkdownView);
    if (view) {
      const editor = view.editor;
      const pos = editor.getCursor();
      editor.replaceRange(`${item.id}	${item.name}`, pos);
      pos.ch += item.id.length;
      editor.setCursor(pos);
    }
  }
};
var KeySequenceShortcutPlugin = class extends import_obsidian.Plugin {
  readKssInit(kss_config) {
    g_all_key_items = [];
    kss_config.split("\n").forEach((line, index) => {
      line = line.trim();
      if (line.length > 0 && line[0] != '"') {
        const split = line.split("	");
        if (split.length != 2 && split.length != 3) {
          console.log(`Skip line ${index} "${line}": the format should be "key-sequence<TAB>command-id<TAB>description", the last field "description" is optional.`);
          return;
        }
        const key_item = { key_sequence: split[0], command: split[1], description: split.length == 3 ? split[2] : "" };
        g_all_key_items.push(key_item);
      }
    });
  }
  onload() {
    return __async(this, null, function* () {
      yield this.loadSettings();
      this.load_kssrc_file();
      this.addCommand({
        id: "open-key-sequence-palette",
        name: "Open Key Sequence Palette (Menu)",
        icon: "any-key",
        hotkeys: [{ modifiers: ["Ctrl"], key: "m" }],
        callback: () => {
          new KeySequenceModal(this.app).open();
        }
      });
      this.addCommand({
        id: "insert-command-id",
        name: "Insert Command Id and Name",
        hotkeys: [{ modifiers: ["Ctrl", "Shift"], key: "8" }],
        icon: "duplicate-glyph",
        callback: () => {
          new InsertCommandIdModel(this.app).open();
        }
      });
      this.addCommand({
        id: "reload-kssrc",
        name: "Reload Key Sequence Shortcut Config File",
        icon: "play-audio-glyph",
        callback: () => __async(this, null, function* () {
          yield this.load_kssrc_file();
        })
      });
      this.settingTab = new KeySequenceShortcutSettingTab(this.app, this);
      this.addSettingTab(this.settingTab);
      console.log("KeySequenceShortcutPlugin load successfully.");
    });
  }
  load_kssrc_file() {
    return __async(this, null, function* () {
      try {
        const lines = yield this.app.vault.adapter.read(this.settings.kssrc_file_path);
        this.readKssInit(lines);
      } catch (error) {
        console.log("Error loading kssrc file", this.settings.kssrc_file_path, "from the vault root", error);
      }
    });
  }
  loadSettings() {
    return __async(this, null, function* () {
      this.settings = Object.assign({}, DEFAULT_SETTINGS, yield this.loadData());
    });
  }
  saveSettings() {
    return __async(this, null, function* () {
      yield this.saveData(this.settings);
      this.load_kssrc_file();
    });
  }
  onunload() {
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgQXBwLCBGdXp6eVN1Z2dlc3RNb2RhbCwgTWFya2Rvd25WaWV3LCBQbHVnaW4sIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7IENvbW1hbmQsIFN1Z2dlc3RNb2RhbCB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5cclxuaW50ZXJmYWNlIEtleVNlcXVlbmNlU2hvcnRjdXRTZXR0aW5ncyB7XHJcblx0a3NzcmNfZmlsZV9wYXRoOiBzdHJpbmdcclxufVxyXG5cclxuY29uc3QgREVGQVVMVF9TRVRUSU5HUzogUGFydGlhbDxLZXlTZXF1ZW5jZVNob3J0Y3V0U2V0dGluZ3M+ID0ge1xyXG5cdGtzc3JjX2ZpbGVfcGF0aDogXCJrc3NyYy5tZFwiXHJcbn07XHJcblxyXG5leHBvcnQgY2xhc3MgS2V5U2VxdWVuY2VTaG9ydGN1dFNldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcclxuICBwbHVnaW46IEtleVNlcXVlbmNlU2hvcnRjdXRQbHVnaW47XHJcblxyXG4gIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IEtleVNlcXVlbmNlU2hvcnRjdXRQbHVnaW4pIHtcclxuICAgIHN1cGVyKGFwcCwgcGx1Z2luKTtcclxuICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG4gIH1cclxuXHJcbiAgZGlzcGxheSgpOiB2b2lkIHtcclxuICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XHJcbiAgICBjb250YWluZXJFbC5lbXB0eSgpO1xyXG5cclxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZShcIkNvbmZpZyBGaWxlXCIpXHJcbiAgICAgIC5hZGRUZXh0KCh0ZXh0KSA9PlxyXG4gICAgICAgIHRleHRcclxuICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcihcIlwiKVxyXG4gICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmtzc3JjX2ZpbGVfcGF0aClcclxuICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Mua3NzcmNfZmlsZV9wYXRoPSB2YWx1ZTtcclxuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICApO1xyXG4gIH1cclxufVxyXG5cclxuaW50ZXJmYWNlIEtleUl0ZW0ge1xyXG5cdGtleV9zZXF1ZW5jZTogc3RyaW5nO1xyXG5cdGNvbW1hbmQ6IHN0cmluZztcclxuXHRkZXNjcmlwdGlvbjogc3RyaW5nLFxyXG59XHJcblxyXG5sZXQgZ19hbGxfa2V5X2l0ZW1zOiBLZXlJdGVtW10gPSBbXTtcclxuXHJcbmV4cG9ydCBjbGFzcyBLZXlTZXF1ZW5jZU1vZGFsIGV4dGVuZHMgU3VnZ2VzdE1vZGFsPEtleUl0ZW0+IHtcclxuXHQvLyBSZXR1cm5zIGFsbCBhdmFpbGFibGUgc3VnZ2VzdGlvbnMuXHJcblx0Z2V0U3VnZ2VzdGlvbnMocXVlcnk6IHN0cmluZyk6IEtleUl0ZW1bXSB7XHJcblx0XHRjb25zdCByZXN1bHQgPSBnX2FsbF9rZXlfaXRlbXMuZmluZCgoa2V5X2l0ZW0pID0+IHtcclxuXHRcdFx0cmV0dXJuIGtleV9pdGVtLmtleV9zZXF1ZW5jZSA9PSBxdWVyeTtcclxuXHRcdH0pXHJcblxyXG5cdFx0aWYgKHJlc3VsdCAhPSBudWxsKSB7XHJcblx0XHRcdHRoaXMuY2xvc2UoKTtcclxuXHRcdFx0dGhpcy5kZWxheSgxMDApLnRoZW4oZGF0YSA9PiB7dGhpcy5leGVjdXRlKHJlc3VsdCk7fSApXHJcblx0XHR9XHJcblx0XHRyZXR1cm4gZ19hbGxfa2V5X2l0ZW1zLmZpbHRlcigoa2V5X2l0ZW0pID0+XHJcblx0XHRcdGtleV9pdGVtLmtleV9zZXF1ZW5jZS5zdGFydHNXaXRoKHF1ZXJ5KVxyXG5cdFx0KTtcclxuXHR9XHJcblxyXG5cdC8vIFJlbmRlcnMgZWFjaCBzdWdnZXN0aW9uIGl0ZW0uXHJcblx0cmVuZGVyU3VnZ2VzdGlvbihrZXlfaXRlbTogS2V5SXRlbSwgZWw6IEhUTUxFbGVtZW50KSB7XHJcblx0XHRlbC5jcmVhdGVFbChcImRpdlwiLCB7IHRleHQ6IGtleV9pdGVtLmtleV9zZXF1ZW5jZSArIFwiOiBcIiArIChrZXlfaXRlbS5kZXNjcmlwdGlvbiA9PSBcIlwiID8ga2V5X2l0ZW0uY29tbWFuZCA6IGtleV9pdGVtLmRlc2NyaXB0aW9uKSB9KTtcclxuXHR9XHJcblxyXG5cdC8vIFBlcmZvcm0gYWN0aW9uIG9uIHRoZSBzZWxlY3RlZCBzdWdnZXN0aW9uLlxyXG5cdG9uQ2hvb3NlU3VnZ2VzdGlvbihrZXlfaXRlbTogS2V5SXRlbSwgZXZ0OiBNb3VzZUV2ZW50IHwgS2V5Ym9hcmRFdmVudCkge1xyXG5cdFx0dGhpcy5leGVjdXRlKGtleV9pdGVtKTtcclxuXHR9XHJcblxyXG5cdGV4ZWN1dGUoa2V5X2l0ZW06IEtleUl0ZW0pIHtcclxuXHRcdGNvbnNvbGUubG9nKGBFeGVjdXRlICR7a2V5X2l0ZW0ua2V5X3NlcXVlbmNlfTogJHtrZXlfaXRlbS5jb21tYW5kfWApO1xyXG5cdFx0KHRoaXMuYXBwIGFzIGFueSkuY29tbWFuZHMuZXhlY3V0ZUNvbW1hbmRCeUlkKGtleV9pdGVtLmNvbW1hbmQpO1xyXG5cdH1cclxuXHJcblx0YXN5bmMgZGVsYXkobXM6IG51bWJlcikge1xyXG5cdFx0cmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCBtcykpO1xyXG5cdH1cclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEluc2VydENvbW1hbmRJZE1vZGVsIGV4dGVuZHMgRnV6enlTdWdnZXN0TW9kYWw8Q29tbWFuZD4ge1xyXG5cdGdldEl0ZW1zKCk6IENvbW1hbmRbXSB7XHJcblx0XHRyZXR1cm4gT2JqZWN0LnZhbHVlcygodGhpcy5hcHAgYXMgYW55KS5jb21tYW5kcy5jb21tYW5kcyk7XHJcblx0fVxyXG5cclxuXHRnZXRJdGVtVGV4dChpdGVtOiBDb21tYW5kKTogc3RyaW5nIHtcclxuXHRcdHJldHVybiBpdGVtLm5hbWUgKyBcIiAtPiBcIiArIGl0ZW0uaWQ7XHJcblx0fVxyXG5cclxuXHRvbkNob29zZUl0ZW0oaXRlbTogQ29tbWFuZCwgZXZ0OiBNb3VzZUV2ZW50IHwgS2V5Ym9hcmRFdmVudCk6IHZvaWQge1xyXG5cdFx0Y29uc29sZS5sb2codGhpcy5nZXRJdGVtVGV4dChpdGVtKSk7XHJcblx0XHRjb25zdCB2aWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcclxuXHRcdGlmICh2aWV3KSB7XHJcblx0XHRcdGNvbnN0IGVkaXRvciA9IHZpZXcuZWRpdG9yO1xyXG5cdFx0XHRjb25zdCBwb3MgPSBlZGl0b3IuZ2V0Q3Vyc29yKCk7XHJcblx0XHRcdGVkaXRvci5yZXBsYWNlUmFuZ2UoYCR7aXRlbS5pZH1cXHQke2l0ZW0ubmFtZX1gLCBwb3MpO1xyXG5cdFx0XHRwb3MuY2ggKz0gaXRlbS5pZC5sZW5ndGg7XHJcblx0XHRcdGVkaXRvci5zZXRDdXJzb3IocG9zKTtcclxuXHRcdH1cclxuXHJcblx0fVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBLZXlTZXF1ZW5jZVNob3J0Y3V0UGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcclxuXHRzZXR0aW5nczogS2V5U2VxdWVuY2VTaG9ydGN1dFNldHRpbmdzO1xyXG5cdHNldHRpbmdUYWI6IEtleVNlcXVlbmNlU2hvcnRjdXRTZXR0aW5nVGFiO1xyXG5cclxuXHRyZWFkS3NzSW5pdChrc3NfY29uZmlnOiBzdHJpbmcpIHtcclxuXHRcdGdfYWxsX2tleV9pdGVtcyA9IFtdO1xyXG5cdFx0a3NzX2NvbmZpZy5zcGxpdChcIlxcblwiKS5mb3JFYWNoKFxyXG5cdFx0XHQobGluZTogc3RyaW5nLCBpbmRleDogbnVtYmVyKSA9PiB7XHJcblx0XHRcdFx0bGluZSA9IGxpbmUudHJpbSgpO1xyXG5cdFx0XHRcdGlmIChsaW5lLmxlbmd0aCA+IDAgJiYgbGluZVswXSAhPSAnXCInKSB7XHJcblx0XHRcdFx0XHRjb25zdCBzcGxpdCA9IGxpbmUuc3BsaXQoXCJcXHRcIik7XHJcblx0XHRcdFx0XHRpZiAoKHNwbGl0Lmxlbmd0aCAhPSAyKSAmJiAoc3BsaXQubGVuZ3RoICE9IDMpICkge1xyXG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZyhgU2tpcCBsaW5lICR7aW5kZXh9IFwiJHtsaW5lfVwiOiB0aGUgZm9ybWF0IHNob3VsZCBiZSBcImtleS1zZXF1ZW5jZTxUQUI+Y29tbWFuZC1pZDxUQUI+ZGVzY3JpcHRpb25cIiwgdGhlIGxhc3QgZmllbGQgXCJkZXNjcmlwdGlvblwiIGlzIG9wdGlvbmFsLmApXHJcblx0XHRcdFx0XHRcdHJldHVyblxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0Ly8gRklYTUU6IFdlIGNhbid0IGNoZWNrIHdoZW4gbG9hZGluZyB0aGUgcGx1Z2luLCBhdCB0aGlzIHRpbWUsIHRoZSBjb21tYW5kcyBsaXN0IGlzIG5vdCBjb21wbGV0ZVxyXG5cdFx0XHRcdFx0Ly8gaWYoISAoc3BsaXRbMV0gaW4gKHRoaXMuYXBwIGFzIGFueSkuY29tbWFuZHMuY29tbWFuZHMpKVxyXG5cdFx0XHRcdFx0Ly8ge1xyXG5cdFx0XHRcdFx0Ly8gXHRjb25zb2xlLmxvZyhgU2tpcCBsaW5lICR7aW5kZXh9IFwiJHtsaW5lfVwiOiAke3NwbGl0WzFdfSBpcyBub3QgYSB2YWxpZCBjb21tYW5kIGlkLmApO1xyXG5cdFx0XHRcdFx0Ly8gXHRyZXR1cm5cclxuXHRcdFx0XHRcdC8vIH1cclxuXHRcdFx0XHRcdGNvbnN0IGtleV9pdGVtOiBLZXlJdGVtID0geyBrZXlfc2VxdWVuY2U6IHNwbGl0WzBdLCBjb21tYW5kOiBzcGxpdFsxXSwgIGRlc2NyaXB0aW9uOiBzcGxpdC5sZW5ndGggPT0gMyA/IHNwbGl0WzJdIDogXCJcIn1cclxuXHRcdFx0XHRcdGdfYWxsX2tleV9pdGVtcy5wdXNoKGtleV9pdGVtKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdClcclxuXHR9XHJcblxyXG5cdGFzeW5jIG9ubG9hZCgpIHtcclxuXHRcdGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XHJcblxyXG5cdFx0dGhpcy5sb2FkX2tzc3JjX2ZpbGUoKTtcclxuXHJcblx0XHR0aGlzLmFkZENvbW1hbmQoe1xyXG5cdFx0XHRpZDogJ29wZW4ta2V5LXNlcXVlbmNlLXBhbGV0dGUnLFxyXG5cdFx0XHRuYW1lOiAnT3BlbiBLZXkgU2VxdWVuY2UgUGFsZXR0ZSAoTWVudSknLFxyXG5cdFx0XHRpY29uOiAnYW55LWtleScsXHJcblx0XHRcdGhvdGtleXM6IFt7IG1vZGlmaWVyczogWydDdHJsJ10sIGtleTogJ20nIH1dLFxyXG5cdFx0XHRjYWxsYmFjazogKCkgPT4ge1xyXG5cdFx0XHRcdG5ldyBLZXlTZXF1ZW5jZU1vZGFsKHRoaXMuYXBwKS5vcGVuKCk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cclxuXHRcdHRoaXMuYWRkQ29tbWFuZCh7XHJcblx0XHRcdGlkOiAnaW5zZXJ0LWNvbW1hbmQtaWQnLFxyXG5cdFx0XHRuYW1lOiAnSW5zZXJ0IENvbW1hbmQgSWQgYW5kIE5hbWUnLFxyXG5cdFx0XHRob3RrZXlzOiBbeyBtb2RpZmllcnM6IFsnQ3RybCcsICdTaGlmdCddLCBrZXk6ICc4JyB9XSxcclxuXHRcdFx0aWNvbjogXCJkdXBsaWNhdGUtZ2x5cGhcIixcclxuXHRcdFx0Y2FsbGJhY2s6ICgpID0+IHtcclxuXHRcdFx0XHRuZXcgSW5zZXJ0Q29tbWFuZElkTW9kZWwodGhpcy5hcHApLm9wZW4oKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblxyXG5cdFx0dGhpcy5hZGRDb21tYW5kKHtcclxuXHRcdFx0aWQ6ICdyZWxvYWQta3NzcmMnLFxyXG5cdFx0XHRuYW1lOiAnUmVsb2FkIEtleSBTZXF1ZW5jZSBTaG9ydGN1dCBDb25maWcgRmlsZScsXHJcblx0XHRcdGljb246IFwicGxheS1hdWRpby1nbHlwaFwiLFxyXG5cdFx0XHRjYWxsYmFjazogYXN5bmMgKCkgPT4ge1xyXG5cdFx0XHRcdGF3YWl0IHRoaXMubG9hZF9rc3NyY19maWxlKCk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdFx0dGhpcy5zZXR0aW5nVGFiID0gbmV3IEtleVNlcXVlbmNlU2hvcnRjdXRTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKTtcclxuXHRcdHRoaXMuYWRkU2V0dGluZ1RhYih0aGlzLnNldHRpbmdUYWIpO1xyXG5cdFx0Y29uc29sZS5sb2coXCJLZXlTZXF1ZW5jZVNob3J0Y3V0UGx1Z2luIGxvYWQgc3VjY2Vzc2Z1bGx5LlwiKVxyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSBhc3luYyBsb2FkX2tzc3JjX2ZpbGUoKSB7XHJcblx0XHR0cnkge1xyXG5cdFx0XHRjb25zdCBsaW5lcyA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LmFkYXB0ZXIucmVhZCh0aGlzLnNldHRpbmdzLmtzc3JjX2ZpbGVfcGF0aCk7XHJcblx0XHRcdHRoaXMucmVhZEtzc0luaXQobGluZXMpO1xyXG5cdFx0fSBjYXRjaCAoZXJyb3IpXHJcblx0XHR7IFxyXG5cdFx0XHRjb25zb2xlLmxvZygnRXJyb3IgbG9hZGluZyBrc3NyYyBmaWxlJywgdGhpcy5zZXR0aW5ncy5rc3NyY19maWxlX3BhdGgsICdmcm9tIHRoZSB2YXVsdCByb290JywgZXJyb3IpOyBcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcclxuXHRcdHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBhd2FpdCB0aGlzLmxvYWREYXRhKCkpO1xyXG5cdH1cclxuXHJcblx0YXN5bmMgc2F2ZVNldHRpbmdzKCkge1xyXG5cdFx0YXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcclxuXHRcdHRoaXMubG9hZF9rc3NyY19maWxlKCk7XHJcblx0fVxyXG5cclxuXHRvbnVubG9hZCgpIHtcclxuXHJcblx0fVxyXG5cclxufVxyXG4iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLHNCQUF3RjtBQUN4Rix1QkFBc0M7QUFNdEMsSUFBTSxtQkFBeUQ7QUFBQSxFQUM5RCxpQkFBaUI7QUFBQTtBQUdYLGtEQUE0QyxpQ0FBaUI7QUFBQSxFQUdsRSxZQUFZLEtBQVUsUUFBbUM7QUFDdkQsVUFBTSxLQUFLO0FBQ1gsU0FBSyxTQUFTO0FBQUE7QUFBQSxFQUdoQixVQUFnQjtBQUNkLFVBQU0sRUFBRSxnQkFBZ0I7QUFDeEIsZ0JBQVk7QUFFWixRQUFJLHdCQUFRLGFBQ1QsUUFBUSxlQUNSLFFBQVEsQ0FBQyxTQUNSLEtBQ0csZUFBZSxJQUNmLFNBQVMsS0FBSyxPQUFPLFNBQVMsaUJBQzlCLFNBQVMsQ0FBTyxVQUFVO0FBQ3pCLFdBQUssT0FBTyxTQUFTLGtCQUFpQjtBQUN0QyxZQUFNLEtBQUssT0FBTztBQUFBO0FBQUE7QUFBQTtBQVk5QixJQUFJLGtCQUE2QjtBQUUxQixxQ0FBK0IsOEJBQXNCO0FBQUEsRUFFM0QsZUFBZSxPQUEwQjtBQUN4QyxVQUFNLFNBQVMsZ0JBQWdCLEtBQUssQ0FBQyxhQUFhO0FBQ2pELGFBQU8sU0FBUyxnQkFBZ0I7QUFBQTtBQUdqQyxRQUFJLFVBQVUsTUFBTTtBQUNuQixXQUFLO0FBQ0wsV0FBSyxNQUFNLEtBQUssS0FBSyxVQUFRO0FBQUMsYUFBSyxRQUFRO0FBQUE7QUFBQTtBQUU1QyxXQUFPLGdCQUFnQixPQUFPLENBQUMsYUFDOUIsU0FBUyxhQUFhLFdBQVc7QUFBQTtBQUFBLEVBS25DLGlCQUFpQixVQUFtQixJQUFpQjtBQUNwRCxPQUFHLFNBQVMsT0FBTyxFQUFFLE1BQU0sU0FBUyxlQUFlLE9BQVEsVUFBUyxlQUFlLEtBQUssU0FBUyxVQUFVLFNBQVM7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
